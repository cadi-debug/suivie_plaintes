{% extends "base_auth.html" %}

{% block content %}
<div class="auth-card">
    <h2>Connexion Agent</h2>
    
    <form method="post" action="{% url 'login' %}" id="loginForm">
        {% csrf_token %}
        
        {% if form.errors %}
            <div style="background: #ffebee; color: #c62828; padding: 10px; border-radius: 4px; margin-bottom: 15px; font-size: 0.9rem;">
                Identifiant ou mot de passe incorrect.
            </div>
        {% endif %}

        <div class="form-group">
            <label for="id_username">Identifiant (Matricule)</label>
            <input type="text" name="username" autofocus required id="id_username" placeholder="ex: greffier">
        </div>

        <div class="form-group">
            <label for="id_password">Mot de passe</label>
            <input type="password" name="password" required id="id_password" placeholder="••••••••">
        </div>

        <button type="submit" id="submitBtn">
            <span id="buttonText">Se connecter</span>
            <span id="loader" style="display: none;" class="loader"></span>
        </button>
    </form>
    
    <div style="margin-top: 15px; text-align: center; font-size: 0.85rem;">
        <a href="#" style="color: #666; text-decoration: none;">Mot de passe oublié ? Contacter l'administrateur.</a>
    </div>
</div>

<style>
.loader {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid #ffffff;
    border-radius: 50%;
    border-top-color: transparent;
    animation: spin 0.8s linear infinite;
    margin-left: 8px;
    vertical-align: middle;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

button:disabled {
    opacity: 0.7;
    cursor: not-allowed;
}
</style>

<script>
document.getElementById('loginForm').addEventListener('submit', function(e) {
    const submitBtn = document.getElementById('submitBtn');
    const buttonText = document.getElementById('buttonText');
    const loader = document.getElementById('loader');
    
    // Désactiver le bouton et afficher le loader
    submitBtn.disabled = true;
    buttonText.textContent = 'Connexion en cours';
    loader.style.display = 'inline-block';
});
</script>
{% endblock %}